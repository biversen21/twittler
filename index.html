<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
		<script src='moment.js'></script>
		<link rel="Stylesheet" href='styles.css' type='text/css'>
  </head>
  <body>
		<h1 class='title'>Twittler App</h1>
		
		<div class='feedContainer'>
			<h4 class='feedTitle'>All Users Feed</h4>
			<div class='feedButtons'>
				<button type='button' class='feedBtn'>Single Refresh</button>
				<button type='button' class='autoBtn'>Autoload</button>
				<button type='button' class='stopBtn'>Stop Autoload</button>
			</div>
			<div class='container'></div>
		</div>
		
		<div class='viewProfileContainer'>
			<h4 class='profileTitle'>Select User Profile</h4>
			<div class='profileButtons'>
				<button type='button' class='mracus'>View mracus</button>
				<button type='button' class='shawn'>View shawn</button>
				<button type='button' class='sharks'>View sharks</button>
				<button type='button' class='douglas'>View douglas</button>
			</div>
			<div class='profileContainer'>
			</div>
		</div>
		
		<div class='newTweetContainer'>
			<h4 class='newTweetTitle'>Add New Tweet</h4>
			<div class='addNewTweet'>
				<input type='text' name='newTweet' placeholder='Enter Tweet Here'>
				<button type='button'>Post Tweet</button>
			</div>
		</div>
    <script>

      $(document).ready(function(){
        var $body = $('.container');
        $body.html('');
				var timer;
				
				// Function to load tweets
				var newTweets = function() {
					$body.html('');
	        var index = streams.home.length - 1;
	        while(index >= 0){
	          var tweet = streams.home[index];
	          var $tweet = $('<div></div>');
	          $tweet.html('<strong>@' + tweet.user + ': </strong>' + tweet.message + 
												"<strong class='timestamp'> posted: " + moment(tweet.created_at).fromNow() + '</strong>');
	          $tweet.appendTo($body);
	          index -= 1;
					}
				}
				
				var addProfileTweets = function() {
					var $profile = $('.container');
					$profile.html('');
					var index = streams.users.mracus.length - 1;
					while(index >= 0) {
						var tweet = streams.users.mracus[index];
						var $tweet = $('<div></div>');
						$tweet.html('<strong>@' + tweet.user + ': </strong>' + tweet.message + 
												"<strong class='timestamp'> posted: " + moment(tweet.created_at).fromNow() + '</strong>');
						$tweet.appendTo($profile);
						index -= 1;
					}
				}
				
				var autoTweet = function() {
					newTweets()
					timer = setTimeout(autoTweet, 1);
				}
				
				var stopTweets = function() {
					clearTimeout(timer);
				}
				
				newTweets();	// Initial invoke upon page load
				
				$('.feedBtn').on('click', newTweets);
				$('.autoBtn').on('click', autoTweet);
				$('.stopBtn').on('click', stopTweets);
				$('.mracus').on('click', addProfileTweets);
      });

    </script>
  </body>
</html>