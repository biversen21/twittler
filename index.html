<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
		<script src='moment.js'></script>
		<link rel="Stylesheet" href='styles.css' type='text/css'>
  </head>
  <body>
		<h1 class='title'>Twittler App</h1>
		<div class='feedContainer'>
			<h4 class='feedTitle'>All Users Feed</h4>
			<div class='container'></div>
		</div>
		<div class='buttons'>
			<button type='button' class='feedBtn'>Single Refresh</button>
			<button type='button' class='autoBtn'>Autoload</button>
			<button type='button' class='stopBtn'>Stop Autoload</button>
		</div>
    <script>

      $(document).ready(function(){
        var $body = $('.container');
        $body.html('');
				var timer;
				
				// Function to load tweets
				var newTweets = function() {
					$body.html('');
	        var index = streams.home.length - 1;
					var origIndex = index  // Store original index of first list
	        while(index >= 0){
	          var tweet = streams.home[index];
	          var $tweet = $('<div></div>');
            $tweet.text('@' + tweet.user + ': ' + tweet.message + ' created at: ' + moment(tweet.created_at).fromNow());
	          $tweet.appendTo($body);
	          index -= 1;
					}
				}
				
				var autoTweet = function() {
					newTweets()
					timer = setTimeout(autoTweet, 1);
				}
				
				var stopTweets = function() {
					clearTimeout(timer);
				}
				
				newTweets();	// Initial invoke upon page load
				
				$('.feedBtn').on('click', newTweets);
				$('.autoBtn').on('click', autoTweet);
				$('.stopBtn').on('click', stopTweets);
      });

    </script>
  </body>
</html>